<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The BBS Signature Scheme</title>
<meta content="Tobias Looker" name="author">
<meta content="Vasilis Kalos" name="author">
<meta content="Andrew Whitehead" name="author">
<meta content="Mike Lodder" name="author">
<meta content="
       BBS is a digital signature scheme categorized as a form of short group signature that supports several unique properties. Notably, the scheme supports signing multiple messages whilst producing a single output digital signature. Through this capability, the possessor of a signature is able to generate proofs that selectively disclose subsets of the originally signed set of messages, whilst preserving the verifiable authenticity and integrity of the messages. Furthermore, these proofs are said to be zero-knowledge in nature as they do not reveal the underlying signature; instead, what they reveal is a proof of knowledge of the undisclosed signature. 
    " name="description">
<meta content="xml2rfc 3.14.2" name="generator">
<meta content="draft-looker-cfrg-bbs-signatures-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.14.2
    Python 3.10.5
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.1
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
-->
<link href="draft-looker-cfrg-bbs-signatures.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 20ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
dl .break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The BBS Signature Scheme</td>
<td class="right">September 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Looker, et al.</td>
<td class="center">Expires 16 March 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CFRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-looker-cfrg-bbs-signatures-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-09-12" class="published">12 September 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-03-16">16 March 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">MATTR</div>
</div>
<div class="author">
      <div class="author-name">V. Kalos</div>
<div class="org">MATTR</div>
</div>
<div class="author">
      <div class="author-name">A. Whitehead</div>
<div class="org">Portage</div>
</div>
<div class="author">
      <div class="author-name">M. Lodder</div>
<div class="org">CryptID</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The BBS Signature Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BBS is a digital signature scheme categorized as a form of short group signature that supports several unique properties. Notably, the scheme supports signing multiple messages whilst producing a single output digital signature. Through this capability, the possessor of a signature is able to generate proofs that selectively disclose subsets of the originally signed set of messages, whilst preserving the verifiable authenticity and integrity of the messages. Furthermore, these proofs are said to be zero-knowledge in nature as they do not reveal the underlying signature; instead, what they reveal is a proof of knowledge of the undisclosed signature.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/decentralized-identity/bbs-signature">https://github.com/decentralized-identity/bbs-signature</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 March 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-notation" class="xref">Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-organization-of-this-docume" class="xref">Organization of this document</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-scheme-definition" class="xref">Scheme Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-parameters" class="xref">Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-considerations" class="xref">Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-subgroup-selection" class="xref">Subgroup Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-messages-and-generators" class="xref">Messages and generators</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-key-generation-operations" class="xref">Key Generation Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-keygen" class="xref">KeyGen</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-sktopk" class="xref">SkToPk</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-core-operations" class="xref">Core Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-sign" class="xref">Sign</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-verify" class="xref">Verify</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-proofgen" class="xref">ProofGen</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-proofverify" class="xref">ProofVerify</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-utility-operations" class="xref">Utility Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-generator-point-computation" class="xref">Generator point computation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-mapmessagetoscalar" class="xref">MapMessageToScalar</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-mapmessagetoscalarashash" class="xref">MapMessageToScalarAsHash</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-hash-to-scalar" class="xref">Hash to Scalar</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-serialization" class="xref">Serialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-octetstosignature" class="xref">OctetsToSignature</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-signaturetooctets" class="xref">SignatureToOctets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="xref">4.4.3</a>.  <a href="#name-octetstoproof" class="xref">OctetsToProof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="xref">4.4.4</a>.  <a href="#name-prooftooctets" class="xref">ProofToOctets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="xref">4.4.5</a>.  <a href="#name-octetstopublickey" class="xref">OctetsToPublicKey</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.6">
                    <p id="section-toc.1-1.4.2.4.2.6.1"><a href="#section-4.4.6" class="xref">4.4.6</a>.  <a href="#name-encodeforhash" class="xref">EncodeForHash</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-validating-public-keys" class="xref">Validating public keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-point-de-serialization" class="xref">Point de-serialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-skipping-membership-checks" class="xref">Skipping membership checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-side-channel-attacks" class="xref">Side channel attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-randomness-considerations" class="xref">Randomness considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-presentation-header-selecti" class="xref">Presentation header selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-implementing-hash_to_curve_" class="xref">Implementing hash_to_curve_g1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-choice-of-underlying-curve" class="xref">Choice of underlying curve</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-security-of-proofs-generate" class="xref">Security of proofs generated by ProofGen</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-ciphersuite-format" class="xref">Ciphersuite Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-ciphersuite-id" class="xref">Ciphersuite ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-additional-parameters" class="xref">Additional Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-bls12-381-ciphersuites" class="xref">BLS12-381 Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-bls12-381-shake-256" class="xref">BLS12-381-SHAKE-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-bls12-381-sha-256" class="xref">BLS12-381-SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-bls12-381-hash_to_curve-def" class="xref">BLS12-381 hash_to_curve definition using SHAKE-256</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-bls12-381-g1" class="xref">BLS12-381 G1</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-non-correlating-security-to" class="xref">Non-correlating Security Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-improved-bearer-security-to" class="xref">Improved Bearer Security Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-selectively-disclosure-enab" class="xref">Selectively Disclosure Enabled Identity Credentials</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-additional-bls12-381-cipher" class="xref">Additional BLS12-381 Ciphersuite Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-modified-message-signature" class="xref">Modified Message Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-extra-unsigned-message-sign" class="xref">Extra Unsigned Message Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-missing-message-signature" class="xref">Missing Message Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-reordered-message-signature" class="xref">Reordered Message Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#appendix-C.5" class="xref">C.5</a>.  <a href="#name-wrong-public-key-signature" class="xref">Wrong Public Key Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#appendix-C.6" class="xref">C.6</a>.  <a href="#name-wrong-public-key-signature-2" class="xref">Wrong Public Key Signature</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-proof-generation-and-verifi" class="xref">Proof Generation and Verification Algorithmic Explanation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="xref">Appendix E</a>.  <a href="#name-document-history" class="xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-F" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A digital signature scheme is a fundamental cryptographic primitive that is used to provide data integrity and verifiable authenticity in various protocols. The core premise of digital signature technology is built upon asymmetric cryptography where-by the possessor of a private key is able to sign a message, where anyone in possession of the corresponding public key matching that of the private key is able to verify the signature.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The name BBS is derived from the authors of the original academic work of Dan Boneh, Xavier Boyen, and Hovav Shacham, where the scheme was first described.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Beyond the core properties of a digital signature scheme, BBS signatures provide multiple additional unique properties, three key ones are:<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><strong>Selective Disclosure</strong> - The scheme allows a signer to sign multiple messages and produce a single -constant size- output signature. A holder/prover then possessing the messages and the signature can generate a proof whereby they can choose which messages to disclose, while revealing no-information about the undisclosed messages. The proof itself guarantees the integrity and authenticity of the disclosed messages (e.g. that they were originally signed by the signer).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><strong>Unlinkable Proofs</strong> - The proofs generated by the scheme are known as zero-knowledge, proofs-of-knowledge of the signature, meaning a verifying party in receipt of a proof is unable to determine which signature was used to generate the proof, removing a common source of correlation. In general, each proof generated is indistinguishable from random even for two proofs generated from the same signature.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"><strong>Proof of Possession</strong> - The proofs generated by the scheme prove to a verifier that the party who generated the proof (holder/prover) was in possession of a signature without revealing it. The scheme also supports binding a presentation header to the generated proof. The presentation header can include arbitrary information such as a cryptographic nonce, an audience/domain identifier and or time based validity information.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Refer to the <a href="#use-cases" class="xref">Appendix B</a> for an elaboration on situations where these properties are useful<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Below is a basic diagram describing the main entities involved in the scheme<a href="#section-1-8" class="pilcrow">¶</a></p>
<span id="name-basic-diagram-capturing-the"></span><figure id="figure-1">
        <div id="section-1-9.1">
<pre class="lang-ascii-art sourcecode">  (1) sign                                      (3) ProofGen
   +-----                                         +-----
   |    |                                         |    |
   |    |                                         |    |
   |   \ /                                        |   \ /
+----------+                                   +-----------+
|          |                                   |           |
|          |                                   |           |
|          |                                   |           |
|  Signer  |---(2)* Send signature + msgs-----&gt;|  Holder/  |
|          |                                   |  Prover   |
|          |                                   |           |
|          |                                   |           |
+----------+                                   +-----------+
                                                     |
                                                     |
                                                     |
                                      (4)* Send proof + disclosed msgs
                                                     |
                                                     |
                                                    \ /
                                               +-----------+
                                               |           |
                                               |           |
                                               |           |
                                               | Verifier  |
                                               |           |
                                               |           |
                                               |           |
                                               +-----------+
                                                  |   / \
                                                  |    |
                                                  |    |
                                                  +-----
                                             (5) ProofVerify


</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-basic-diagram-capturing-the" class="selfRef">Basic diagram capturing the main entities involved in using the scheme</a>
        </figcaption></figure>
<p id="section-1-10"><strong>Note</strong> The protocols implied by the items annotated by an asterisk are out of scope for this specification<a href="#section-1-10" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The following terminology is used throughout this document:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">SK</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">The secret key for the signature scheme.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">PK</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">The public key for the signature scheme.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">L</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">The total number of signed messages.<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.7">R</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.8">The number of message indexes that are disclosed (revealed) in a proof-of-knowledge of a signature.<a href="#section-1.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.9">U</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.10">The number of message indexes that are undisclosed in a proof-of-knowledge of a signature.<a href="#section-1.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.11">msg</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.12">An input message to be signed by the signature scheme.<a href="#section-1.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.13">generator</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.14">A valid point on the selected subgroup of the curve being used that is employed to commit a value.<a href="#section-1.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.15">signature</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.16">The digital signature output.<a href="#section-1.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.17">nonce</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.18">A cryptographic nonce<a href="#section-1.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.19">presentation_header (ph)</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.20">A payload generated and bound to the context of a specific spk.<a href="#section-1.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.21">nizk</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.22">A non-interactive zero-knowledge proof from fiat-shamir heuristic.<a href="#section-1.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.23">dst</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.24">The domain separation tag.<a href="#section-1.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.25">I2OSP</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.26">As defined by Section 4 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span><a href="#section-1.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.27">OS2IP</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.28">As defined by Section 4 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>.<a href="#section-1.1-2.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="notation">
<section id="section-1.2">
        <h3 id="name-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-1.2-1">The following notation and primitives are used:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">a || b</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.2">Denotes the concatenation of octet strings a and b.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.3">I \ J</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.4">For sets I and J, denotes the difference of the two sets i.e., all the elements of I that do not appear in J, in the same order as they were in I.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.5">X[a..b]</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.6">Denotes a slice of the array <code>X</code> containing all elements from and including the value at index <code>a</code> until and including the value at index <code>b</code>. Note when this syntax is applied to an octet string, each element in the array <code>X</code> is assumed to be a single byte.<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.7">range(a, b)</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.8">For integers a and b, with a &lt;= b, denotes the ascending ordered list of all integers between a and b inclusive (i.e., the integers "i" such that a &lt;= i &lt;= b).<a href="#section-1.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.9">utf8(ascii_string)</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.10">Encoding the inputted ASCII string to an octet string using UTF-8 character encoding.<a href="#section-1.2-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.11">length(input)</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.12">Takes as input either an array or an octet string. If the input is an array, returns the number of elements of the array. If the input is an octet string, returns the number of bytes of the inputted octet string.<a href="#section-1.2-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-3">Terms specific to pairing-friendly elliptic curves that are relevant to this document are restated below, originally defined in <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span><a href="#section-1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-4">
          <dt id="section-1.2-4.1">E1, E2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.2">elliptic curve groups defined over finite fields. This document assumes that E1 has a more compact representation than E2, i.e., because E1 is defined over a smaller field than E2.<a href="#section-1.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.3">G1, G2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.4">subgroups of E1 and E2 (respectively) having prime order r.<a href="#section-1.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.5">GT</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.6">a subgroup, of prime order r, of the multiplicative group of a field extension.<a href="#section-1.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.7">e</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.8">G1 x G2 -&gt; GT: a non-degenerate bilinear map.<a href="#section-1.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.9">r</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.10">The prime order of the G1 and G2 subgroups.<a href="#section-1.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.11">P1, P2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.12">points on G1 and G2 respectively. For a pairing-friendly curve, this document denotes operations in E1 and E2 in additive notation, i.e., P + Q denotes point addition and x * P denotes scalar multiplication. Operations in GT are written in multiplicative notation, i.e., a * b is field multiplication.<a href="#section-1.2-4.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.13">Identity_G1, Identity_G2, Identity_GT</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.14">The identity element for the G1, G2, and GT subgroups respectively.<a href="#section-1.2-4.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.15">hash_to_curve_g1(ostr, dst) -&gt; P</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.16">A cryptographic hash function that takes an arbitrary octet string as input and returns a point in G1, using the hash_to_curve operation defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> and the inputted dst as the domain separation tag for that operation (more specifically, the inputted dst will become the DST parameter for the hash_to_field operation, called by hash_to_curve).<a href="#section-1.2-4.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.17">point_to_octets_g1(P) -&gt; ostr, point_to_octets_g2(P) -&gt; ostr</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.18">returns the canonical representation of the point P for the respective subgroup as an octet string. This operation is also known as serialization.<a href="#section-1.2-4.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.19">octets_to_point_g1(ostr) -&gt; P, octets_to_point_g2(ostr) -&gt; P</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.20">returns the point P for the respective subgroup corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of the respective point_to_octets_g* function. This operation is also known as deserialization.<a href="#section-1.2-4.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.21">subgroup_check(P) -&gt; VALID or INVALID</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.22">returns VALID when the point P is an element of the subgroup of order r, and INVALID otherwise. This function can always be implemented by checking that r * P is equal to the identity element. In some cases, faster checks may also exist, e.g., <span>[<a href="#Bowe19" class="xref">Bowe19</a>]</span>.<a href="#section-1.2-4.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="organization-of-this-document">
<section id="section-1.3">
        <h3 id="name-organization-of-this-docume">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-organization-of-this-docume" class="section-name selfRef">Organization of this document</a>
        </h3>
<p id="section-1.3-1">This document is organized as follows:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">
            <p id="section-1.3-2.1.1"><a href="#scheme-definition">Scheme Definition</a> defines the core operations and parameters for the BBS signature scheme.<a href="#section-1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.2">
            <p id="section-1.3-2.2.1"><a href="#utility-operations">Utility Operations</a> defines utilities used by the BBS signature scheme.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.3">
            <p id="section-1.3-2.3.1"><a href="#security-considerations">Security Considerations</a> describes a set of security considerations associated to the signature scheme.<a href="#section-1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.4">
            <p id="section-1.3-2.4.1"><a href="#ciphersuites">Ciphersuites</a> defines the format of a ciphersuite, alongside a concrete ciphersuite based on the BLS12-381 curve.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The keywords <span class="bcp14">MUST</span>, <span class="bcp14">MUST NOT</span>, <span class="bcp14">REQUIRED</span>, <span class="bcp14">SHALL</span>, <span class="bcp14">SHALL NOT</span>, <span class="bcp14">SHOULD</span>,
<span class="bcp14">SHOULD NOT</span>, <span class="bcp14">RECOMMENDED</span>, <span class="bcp14">MAY</span>, and <span class="bcp14">OPTIONAL</span>, when they appear in this
document, are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scheme-definition">
<section id="section-3">
      <h2 id="name-scheme-definition">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-scheme-definition" class="section-name selfRef">Scheme Definition</a>
      </h2>
<p id="section-3-1">This section defines the BBS signature scheme, including the parameters required to define a concrete ciphersuite.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="parameters">
<section id="section-3.1">
        <h3 id="name-parameters">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-3.1-1">The schemes operations defined in this section depend on the following parameters:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">A pairing-friendly elliptic curve, plus associated functionality given in <a href="#notation">Section 1.2</a>.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">A hash-to-curve suite as defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>, using the aforementioned pairing-friendly curve. This defines the hash_to_curve and expand_message operations, used by this document.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">PRF(n): a pseudo-random function similar to <span>[<a href="#RFC4868" class="xref">RFC4868</a>]</span>. Returns n pseudo randomly generated bytes.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="considerations">
<section id="section-3.2">
        <h3 id="name-considerations">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-considerations" class="section-name selfRef">Considerations</a>
        </h3>
<div id="subgroup-selection">
<section id="section-3.2.1">
          <h4 id="name-subgroup-selection">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-subgroup-selection" class="section-name selfRef">Subgroup Selection</a>
          </h4>
<p id="section-3.2.1-1">In definition of this signature scheme there are two possible variations based upon the sub-group selection, namely where public keys are defined in G2 and signatures in G1 OR the opposite where public keys are defined in G1 and signatures in G2. Some pairing cryptography based digital signature schemes such as <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="xref">I-D.irtf-cfrg-bls-signature</a>]</span> elect to allow for both variations, because they optimize for different things. However, in the case of this scheme, due to the operations involved in both signature and proof generation being computational in-efficient when performed in G2 and in the pursuit of simplicity, the scheme is limited to a construction where public keys are in G2 and signatures in G1.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="messages-and-generators">
<section id="section-3.2.2">
          <h4 id="name-messages-and-generators">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-messages-and-generators" class="section-name selfRef">Messages and generators</a>
          </h4>
<p id="section-3.2.2-1">Throughout the operations of this signature scheme, each message that is signed is paired with a specific generator (point in G1). Specifically, if a generator <code>H_1</code> is multiplied with <code>msg_1</code> during signing, then <code>H_1</code> MUST be multiplied with <code>msg_1</code> in all other operations (signature verification, proof generation and proof verification).<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">Aside from the message generators, the scheme uses two additional generators: <code>Q_1</code> and <code>Q_2</code>. The first (<code>Q_1</code>), is used for the blinding value (<code>s</code>) of the signature. The second generator (<code>Q_2</code>), is used to sign the signature's domain, which binds both the signature and generated proofs to a specific context and cryptographically protects any potential application-specific information (for example, messages that must always be disclosed etc.).<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-generation-operations">
<section id="section-3.3">
        <h3 id="name-key-generation-operations">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-key-generation-operations" class="section-name selfRef">Key Generation Operations</a>
        </h3>
<div id="keygen">
<section id="section-3.3.1">
          <h4 id="name-keygen">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-keygen" class="section-name selfRef">KeyGen</a>
          </h4>
<p id="section-3.3.1-1">This operation generates a secret key (SK) deterministically from a secret octet string (IKM).<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">KeyGen uses an HKDF <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> instantiated with the hash function hash.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">For security, IKM MUST be infeasible to guess, e.g. generated by a trusted source of randomness.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">IKM MUST be at least 32 bytes long, but it MAY be longer.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">Because KeyGen is deterministic, implementations MAY choose either to store the resulting SK or to store IKM and call KeyGen to derive SK when necessary.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1-6">KeyGen takes an optional parameter, key_info. This parameter MAY be used to derive multiple independent keys from the same IKM.  By default, key_info is the empty string.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.1-7">
<pre>SK = KeyGen(IKM, key_info)

Inputs:

- IKM (REQUIRED), a secret octet string. See requirements above.
- key_info (OPTIONAL), an octet string. if this is not supplied, it
                       MUST default to an empty string.

Definitions:

- HKDF-Extract is as defined in [@!RFC5869], instantiated with hash function hash.
- HKDF-Expand is as defined in [@!RFC5869], instantiated with hash function hash.
- I2OSP and OS2IP are as defined in [@!RFC8017], Section 4.
- L is the integer given by ceil((3 * ceil(log2(r))) / 16).
- INITSALT is the ASCII string "BBS-SIG-KEYGEN-SALT-".

Outputs:

- SK, a uniformly random integer such that 0 &lt; SK &lt; r.

Procedure:

1. salt = INITSALT
2. SK = 0
3. while SK == 0:
4.     salt = hash(salt)
5.     PRK = HKDF-Extract(salt, IKM || I2OSP(0, 1))
6.     OKM = HKDF-Expand(PRK, key_info || I2OSP(L, 2), L)
7.     SK = OS2IP(OKM) mod r
8. return SK
</pre><a href="#section-3.3.1-7" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-8"><strong>Note</strong> This operation is the RECOMMENDED way of generating a secret key, but its use is not required for compatibility, and implementations MAY use a different KeyGen procedure. For security, such an alternative MUST output a secret key that is statistically close to uniformly random in the range 0 &lt; SK &lt; r.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sktopk">
<section id="section-3.3.2">
          <h4 id="name-sktopk">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-sktopk" class="section-name selfRef">SkToPk</a>
          </h4>
<p id="section-3.3.2-1">This operation takes a secret key (SK) and outputs a corresponding public key (PK).<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.2-2">
<pre>PK = SkToPk(SK)

Inputs:

- SK (REQUIRED), a secret integer such that 0 &lt; SK &lt; r.

Outputs:

- PK, a public key encoded as an octet string.

Procedure:

1. W = SK * P2
2. return point_to_octets_g2(W)
</pre><a href="#section-3.3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="core-operations">
<section id="section-3.4">
        <h3 id="name-core-operations">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-core-operations" class="section-name selfRef">Core Operations</a>
        </h3>
<p id="section-3.4-1">The operations in this section make use of a "Precomputations" set of steps. The "Precomputations" steps must be executed before the steps in the "Procedure" of each operation and include computations that can be cached and re-used multiple times (like creating the generators etc.) or procedural steps like de-structuring inputted arrays.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="sign">
<section id="section-3.4.1">
          <h4 id="name-sign">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-sign" class="section-name selfRef">Sign</a>
          </h4>
<p id="section-3.4.1-1">This operation computes a deterministic signature from a secret key (SK) and optionally over a header and or a vector of messages.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-2">
<pre>signature = Sign(SK, PK, header, messages)

Inputs:

- SK (REQUIRED), a non negative integer mod r outputted by the KeyGen
                 operation.
- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation provided the above SK as input.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to an empty string.
- messages (OPTIONAL), a vector of scalars. If not supplied, it defaults
                       to the empty array "()".

Parameters:

- ciphersuite_id, ASCII string. The unique ID of the ciphersuite.

Definitions:

- L, is the non-negative integer representing the number of messages to
     be signed e.g length(messages). If no messages are supplied as an
     input, the value of L MUST evaluate to zero (0).

Outputs:

- signature, a signature encoded as an octet string.

Precomputations:

1. msg_1, ..., msg_L = messages[1], ..., messages[L]
2. (Q_1, Q_2, H_1, ..., H_L) = create_generators(L+2)

Procedure:

1.  dom_array = (PK, L, Q_1, Q_2, H_1, ..., H_L, ciphersuite_id, header)
2.  dom_for_hash = encode_for_hash(dom_array)
3.  if dom_for_hash is INVALID, return INVALID
4.  domain = hash_to_scalar(dom_for_hash, 1)
5.  e_s_for_hash = encode_for_hash((SK, domain, msg_1, ..., msg_L))
6.  if e_s_for_hash is INVALID, return INVALID
7.  (e, s) = hash_to_scalar(e_s_for_hash, 2)
8.  B = P1 + Q_1 * s + Q_2 * domain + H_1 * msg_1 + ... + H_L * msg_L
9.  A = B * (1 / (SK + e))
10. signature_octets = signature_to_octets(A, e, s)
11. return signature_octets
</pre><a href="#section-3.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-3"><strong>Note</strong> When computing step 9 of the above procedure there is an extremely small probability (around <code>2^(-r)</code>) that the condition <code>(SK + e) = 0 mod r</code> will be met. How implementations evaluate the inverse of the scalar value <code>0</code> may vary, with some returning an error and others returning <code>0</code> as a result. If the returned value from the inverse operation <code>1/(SK + e)</code> does evaluate to <code>0</code> the value of <code>A</code> will equal <code>Identity_G1</code> thus an invalid signature. Implementations MAY elect to check <code>(SK + e) = 0 mod r</code> prior to step 9, and or <code>A != Identity_G1</code> after step 9 to prevent the production of invalid signatures.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-3.4.2">
          <h4 id="name-verify">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-verify" class="section-name selfRef">Verify</a>
          </h4>
<p id="section-3.4.2-1">This operation checks that a signature is valid for a given header and vector of messages against a supplied public key (PK). The messages MUST be supplied in this operation in the same order they were supplied to <a href="#sign">Sign</a> when creating the signature.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.2-2">
<pre>result = Verify(PK, signature, header, messages)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to an empty string.
- messages (OPTIONAL), a vector of scalars. If not supplied, it defaults
                       to the empty array "()".

Parameters:

- ciphersuite_id, ASCII string. The unique ID of the ciphersuite.

Definitions:

- L, is the non-negative integer representing the number of messages to
     be signed e.g length(messages). If no messages are supplied as an
     input, the value of L MUST evaluate to zero (0).

Outputs:

- result, either VALID or INVALID.

Precomputations:

1. (msg_1, ..., msg_L) = messages
2. (Q_1, Q_2, H_1, ..., H_L) = create_generators(L+2)

Procedure:

1.  signature_result = octets_to_signature(signature)
2.  if signature_result is INVALID, return INVALID
3.  (A, e, s) = signature_result
4.  W = octets_to_pubkey(PK)
5.  if W is INVALID, return INVALID
6.  dom_array = (PK, L, Q_1, Q_2, H_1, ..., H_L, ciphersuite_id, header)
7.  dom_for_hash = encode_for_hash(dom_array)
8.  if dom_for_hash is INVALID, return INVALID
9.  domain = hash_to_scalar(dom_for_hash, 1)
10. B = P1 + Q_1 * s + Q_2 * domain + H_1 * msg_1 + ... + H_L * msg_L
11. if e(A, W + P2 * e) * e(B, -P2) != Identity_GT, return INVALID
12. return VALID
</pre><a href="#section-3.4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proofgen">
<section id="section-3.4.3">
          <h4 id="name-proofgen">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-proofgen" class="section-name selfRef">ProofGen</a>
          </h4>
<p id="section-3.4.3-1">This operation computes a zero-knowledge proof-of-knowledge of a signature, while optionally selectively disclosing from the original set of signed messages. The "prover" may also supply a presentation header, see <a href="#presentation-header-selection">Presentation header selection</a> for more details.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">The messages supplied in this operation MUST be in the same order as when supplied to <a href="#sign">Sign</a>. To specify which of those messages will be disclosed, the prover can supply the list of indexes (<code>disclosed_indexes</code>) that the disclosed messages have in the array of signed messages. Each element in <code>disclosed_indexes</code> MUST be a non-negative integer, in the range from 1 to <code>length(messages)</code>.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.3-3">
<pre>proof = ProofGen(PK, signature, header, ph, messages, disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to an empty string.
- ph (OPTIONAL), octet string containing the presentation header. If not
                 supplied, it defaults to an empty string.
- messages (OPTIONAL), a vector of scalars. If not supplied, it defaults
                       to the empty array "()".
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. Indexes of disclosed messages. If
                                not supplied, it defaults to the empty
                                array "()".

Parameters:

- ciphersuite_id, ASCII string. The unique ID of the ciphersuite.

Definitions:

- L, is the non-negative integer representing the number of messages,
     i.e., L = length(messages). If no messages are supplied, the
     value of L MUST evaluate to zero (0).
- R, is the non-negative integer representing the number of disclosed
     (revealed) messages, i.e., R = length(disclosed_indexes). If no
     messages are disclosed, R MUST evaluate to zero (0).
- U, is the non-negative integer representing the number of undisclosed
     messages, i.e., U = L - R.
- prf_len = ceil(ceil(log2(r))/8), where r defined by the ciphersuite.

Outputs:

- proof, octet string; or INVALID.

Precomputations:

1. (i1, ..., iR) = disclosed_indexes
2. (j1, ..., jU) = range(1, L) \ disclosed_indexes
3. (msg_1, ..., msg_L) = messages
4. (msg_i1, ..., msg_iR) = (messages[i1], ..., messages[iR])
5. (msg_j1, ..., msg_jU) = (messages[j1], ..., messages[jU])
6. (Q_1, Q_2, MsgGenerators) = create_generators(L+2)
7. (H_1, ..., H_L) = MsgGenerators
8. (H_j1, ..., H_jU) = (MsgGenerators[j1], ..., MsgGenerators[jU])

Procedure:

1.  signature_result = octets_to_signature(signature)
2.  if signature_result is INVALID, return INVALID
3.  (A, e, s) = signature_result
4.  dom_array = (PK, L, Q_1, Q_2, H_1, ..., H_L, ciphersuite_id, header)
5.  dom_for_hash = encode_for_hash(dom_array)
6.  if dom_for_hash is INVALID, return INVALID
7.  domain = hash_to_scalar(dom_for_hash, 1)
8.  (r1, r2, e~, r2~, r3~, s~) = hash_to_scalar(PRF(prf_len), 6)
9.  (m~_j1, ..., m~_jU) = hash_to_scalar(PRF(prf_len), U)
10. B = P1 + Q_1 * s + Q_2 * domain + H_1 * msg_1 + ... + H_L * msg_L
11. r3 = r1 ^ -1 mod r
12. A' = A * r1
13. Abar = A' * (-e) + B * r1
14. D = B * r1 + Q_1 * r2
15. s' = r2 * r3 + s mod r
16. C1 = A' * e~ + Q_1 * r2~
17. C2 = D * (-r3~) + Q_1 * s~ + H_j1 * m~_j1 + ... + H_jU * m~_jU
18. c_array = (A', Abar, D, C1, C2, R, i1, ..., iR,
                       msg_i1, ..., msg_iR, domain, ph)
19. c_for_hash = encode_for_hash(c_array)
20. if c_for_hash is INVALID, return INVALID
21. c = hash_to_scalar(c_for_hash, 1)
22. e^ = c * e + e~ mod r
23. r2^ = c * r2 + r2~ mod r
24. r3^ = c * r3 + r3~ mod r
25. s^ = c * s' + s~ mod r
26. for j in (j1, ..., jU): m^_j = c * msg_j + m~_j mod r
27. proof = (A', Abar, D, c, e^, r2^, r3^, s^, (m^_j1, ..., m^_jU))
28. return proof_to_octets(proof)
</pre><a href="#section-3.4.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proofverify">
<section id="section-3.4.4">
          <h4 id="name-proofverify">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-proofverify" class="section-name selfRef">ProofVerify</a>
          </h4>
<p id="section-3.4.4-1">This operation checks that a proof is valid for a header, vector of disclosed messages (along side their index corresponding to their original position when signed) and presentation header against a public key (PK).<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4.4-2">The operation accepts the list of messages the prover indicated to be disclosed. Those messages MUST be in the same order as when supplied to <a href="#sign">Sign</a> (as a subset of the signed messages list). The operation also requires the total number of signed messages (L). Lastly, it also accepts the indexes that the disclosed messages had in the original array of messages supplied to <a href="#sign">Sign</a> (i.e., the <code>disclosed_indexes</code> list supplied to <a href="#proofgen">ProofGen</a>). Every element in this list MUST be a non-negative integer in the range from 1 to L, in ascending order.<a href="#section-3.4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.4-3">
<pre>result = ProofVerify(PK, proof, L, header, ph,
                     disclosed_messages,
                     disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- proof (REQUIRED), an octet string of the form outputted by the
                    ProofGen operation.
- L (REQUIRED), non-negative integer. The number of signed messages.
- header (OPTIONAL), an optional octet string containing context and
                     application specific information. If not supplied,
                     it defaults to an empty string.
- ph (OPTIONAL), octet string containing the presentation header. If not
                 supplied, it defaults to an empty string.
- disclosed_messages (OPTIONAL), a vector of scalars. If not supplied,
                                 it defaults to the empty array "()".
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. Indexes of disclosed messages. If
                                not supplied, it defaults to the empty
                                array "()".

Parameters:

- ciphersuite_id, ASCII string. The unique ID of the ciphersuite.

Definitions:

- R, is the non-negative integer representing the number of disclosed
     (revealed) messages, i.e., R = length(disclosed_indexes). If no
     messages are disclosed, the value of R MUST evaluate to zero (0).
- U, is the non-negative integer representing the number of undisclosed
     messages, i.e., U = L - R.

Outputs:

- result, either VALID or INVALID.

Precomputations:

1. (i1, ..., iR) = disclosed_indexes
2. (j1, ..., jU) = range(1, L) \ disclosed_indexes
3. (msg_i1, ..., msg_iR) = disclosed_messages
4. (Q_1, Q_2, MsgGenerators) = create_generators(L+2)
5. (H_1, ..., H_L) = MsgGenerators
6. (H_i1, ..., H_iR) = (MsgGenerators[i1], ..., MsgGenerators[iR])
7. (H_j1, ..., H_jU) = (MsgGenerators[j1], ..., MsgGenerators[jU])

Preconditions:

1. for i in (i1, ..., iR), if i &lt; 1 or i &gt; L, return INVALID
2. if length(disclosed_messages) != R, return INVALID

Procedure:

1.  proof_result = octets_to_proof(proof)
2.  if proof_result is INVALID, return INVALID
3.  (A', Abar, D, c, e^, r2^, r3^, s^, (m^_j1,...,m^_jU)) = proof_result
4.  W = octets_to_pubkey(PK)
5.  if W is INVALID, return INVALID
6.  dom_array = (PK, L, Q_1, Q_2, H_1, ..., H_L, ciphersuite_id, header)
7.  dom_for_hash = encode_for_hash(dom_array)
8.  if dom_for_hash is INVALID, return INVALID
9.  domain = hash_to_scalar(dom_for_hash, 1)
10. C1 = (Abar - D) * c + A' * e^ + Q_1 * r2^
11. T = P1 + Q_2 * domain + H_i1 * msg_i1 + ... + H_iR * msg_iR
12. C2 = T * c - D * r3^ + Q_1 * s^ + H_j1 * m^_j1 + ... + H_jU * m^_jU
13. cv_array = (A', Abar, D, C1, C2, R, i1, ..., iR,
                       msg_i1, ..., msg_iR, domain, ph)
14. cv_for_hash = encode_for_hash(cv_array)
15. if cv_for_hash is INVALID, return INVALID
16. cv = hash_to_scalar(cv_for_hash, 1)
17. if c != cv, return INVALID
18. if A' == Identity_G1, return INVALID
19. if e(A', W) * e(Abar, -P2) != Identity_GT, return INVALID
20. return VALID
</pre><a href="#section-3.4.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="utility-operations">
<section id="section-4">
      <h2 id="name-utility-operations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-utility-operations" class="section-name selfRef">Utility Operations</a>
      </h2>
<div id="generator-point-computation">
<section id="section-4.1">
        <h3 id="name-generator-point-computation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-generator-point-computation" class="section-name selfRef">Generator point computation</a>
        </h3>
<p id="section-4.1-1">This operation defines how to create a set of generators that form a part of the public parameters used by the BBS Signature scheme to accomplish operations such as <a href="#sign">Sign</a>, <a href="#verify">Verify</a>, <a href="#proofgen">ProofGen</a> and <a href="#proofverify">ProofVerify</a>. It takes one input, the number of generator points to create, which is determined in part by the number of signed messages.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">As an optimization, implementations MAY cache the result of <code>create_generators</code> for a specific <code>generator_seed</code> (determined by the ciphersuite) and <code>count</code>. The values <code>n</code> and <code>v</code> MAY also be cached in order to efficiently extend a existing list of generator points.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3">
<pre>generators = create_generators(count)

Inputs:

- count (REQUIRED), unsigned integer. Number of generators to create.

Parameters:

- hash_to_curve_suite, the hash to curve suite id defined by the
                       ciphersuite.
- hash_to_curve_g1, the hash_to_curve operation for the G1 subgroup,
                    defined by the suite specified by the
                    hash_to_curve_suite parameter.
- expand_message, the expand_message operation defined by the suite
                  specified by the hash_to_curve_suite parameter.
- generator_seed, octet string. A seed value selected by the
                  ciphersuite.

Definitions:

- seed_dst, the octet string representing the ASCII encoded characters:
           "BBS_" || hash_to_curve_suite || "SIG_GENERATOR_SEED_".
- generator_dst, the octet string representing:
                 "BBS_" || hash_to_curve_suite || "SIG_GENERATOR_DST_",
                 in the ASCII characters encoding.
- seed_len = ceil((ceil(log2(r)) + k)/8), where r and k are defined by
                                          the ciphersuite.

Outputs:

- generators, an array of generators.

Procedure:

1.  v = expand_message(generator_seed, seed_dst, seed_len)
2.  n = 1
3.  for i in range(1, count):
4.     v = expand_message(v || I2OSP(n, 4), seed_dst, seed_len)
5.     n = n + 1
6.     generator_i = Identity_G1
7.     candidate = hash_to_curve_g1(v, generator_dst)
8.     if candidate in (P1, generator_1, ..., generator_i):
9.        go back to step 4
10.    generator_i = candidate
11. return (generator_1, ..., generator_count)
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="mapmessagetoscalar">
<section id="section-4.2">
        <h3 id="name-mapmessagetoscalar">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-mapmessagetoscalar" class="section-name selfRef">MapMessageToScalar</a>
        </h3>
<p id="section-4.2-1">There are multiple ways in which messages can be mapped to their respective scalar values, which is their required form to be used with the <a href="#sign">Sign</a>, <a href="#verify">Verify</a>, <a href="#proofgen">ProofGen</a> and <a href="#proofverify">ProofVerify</a> operations.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="mapmessagetoscalarashash">
<section id="section-4.2.1">
          <h4 id="name-mapmessagetoscalarashash">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-mapmessagetoscalarashash" class="section-name selfRef">MapMessageToScalarAsHash</a>
          </h4>
<p id="section-4.2.1-1">This operation takes an input message and maps it to a scalar value via a cryptographic hash function for the given curve. The operation takes also as an optional input a domain separation tag (dst). If a dst is not supplied, its value MUST default to the octet string returned from utf8(ciphersuite_id || "MAP_MSG_TO_SCALAR_AS_HASH_"), where ciphersuite_id is the ASCII string representing the unique ID of the ciphersuite.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>result = MapMessageToScalarAsHash(msg, dst)

Inputs:

- msg (REQUIRED), octet string.
- dst (OPTIONAL), an octet string representing a domain separation tag.
                  If not supplied, it default to the octet string
                  utf8(ciphersuite_id || "MAP_MSG_TO_SCALAR_AS_HASH_")
                  where ciphersuite_id is defined by the ciphersuite.

Outputs:

- result, a scalar value.

Procedure:

1. msg_for_hash = encode_for_hash(msg)
2. if msg_for_hash is INVALID, return INVALID
3. if length(dst) &gt; 255, return INVALID
4. return hash_to_scalar(msg_for_hash, 1, dst)
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="hash-to-scalar">
<section id="section-4.3">
        <h3 id="name-hash-to-scalar">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-hash-to-scalar" class="section-name selfRef">Hash to Scalar</a>
        </h3>
<p id="section-4.3-1">This operation describes how to hash an arbitrary octet string to <code>n</code> scalar values in the multiplicative group of integers mod r (i.e., values in the range [1, r-1]).  This procedure acts as a helper function, used internally in various places within the operations described in the spec. To map a message to a scalar that would be passed as input to the <a href="#sign">Sign</a>, <a href="#verify">Verify</a>, <a href="#proofgen">ProofGen</a> and <a href="#proofverify">ProofVerify</a> functions, one must use <a href="#mapmessagetoscalar">MapMessageToScalarAsHash</a> instead.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">This operation makes use of expand_message defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>, in a similar way used by the hash_to_field operation of Section 5 from the same document (with the additional checks for getting a scalar that is 0). If an implementer wants to use hash_to_field instead, they MUST use the multiplicative group of integers mod r (Fr), as the target group (F). Note however, that the hash_to_curve document, makes use of hash_to_field with the target group being the multiplicative group of integers mod p (Fp). For this reason, we don't directly use hash_to_field here, rather we define a similar operation (hash_to_scalar), making direct use of the expand_message function, that will be defined by the hash-to-curve suite used (i.e., either expand_message_xmd or expand_message_xof). If someone also has a hash_to_field implementation available, with the target group been Fr, they can use this instead (adding the check for a scalar been 0).<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">The operation takes as input an octet string representing the message to hash (msg), the number of the scalars to return (count) as well as an optional domain separation tag (dst). If a dst is not supplied, its value MUST default to the octet string returned from utf8(ciphersuit_id || "H2S_"), where ciphersuite_id is the ASCII string representing the unique ID of the ciphersuite.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-4">
<pre>scalars = hash_to_scalar(msg_octets, count, dst)

Inputs:

- msg_octets (REQUIRED), octet string. The message to be hashed.
- count (REQUIRED), an integer greater or equal to 1. The number of
                    scalars to output.
- dst (OPTIONAL), an octet string representing a domain separation tag.
                  If not supplied, it defaults to the octet string given
                  by utf8(ciphersuite_id || "H2S_"), where
                  ciphersuite_id is defined by the ciphersuite.

Parameters:

- hash_to_curve_suite, the hash to curve suite id defined by the
                       ciphersuite.
- expand_message, the expand_message operation defined by the suite
                  specified by the hash_to_curve_suite parameter.

Definitions:

- expand_len = ceil((ceil(log2(r))+k)/8), where r and k are defined by
                                          the ciphersuite.

Outputs:

- scalars, an array of non-zero scalars mod r.

Procedure:

1.  len_in_bytes = count * expand_len
2.  t = 0
3.  msg_prime = msg_octets || I2OSP(t, 1) || I2OSP(count, 4)
4.  uniform_bytes = expand_message(msg_prime, dst, len_in_bytes)
5.  for i in (1, ..., count):
6.      tv = uniform_bytes[(i-1)*expand_len..i*expand_len-1]
7.      scalar_i = OS2IP(tv) mod r
8.  if 0 in (scalar_1, ..., scalar_count):
9.      t = t + 1
10.     go back to step 3
11. return (scalar_1, ..., scalar_count)
</pre><a href="#section-4.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="serialization">
<section id="section-4.4">
        <h3 id="name-serialization">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-serialization" class="section-name selfRef">Serialization</a>
        </h3>
<div id="octetstosignature">
<section id="section-4.4.1">
          <h4 id="name-octetstosignature">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-octetstosignature" class="section-name selfRef">OctetsToSignature</a>
          </h4>
<p id="section-4.4.1-1">This operation describes how to decode an octet string, validate it and return the underlying components that make up the signature.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.1-2">
<pre>signature = octets_to_signature(signature_octets)

Inputs:

- signature_octets (REQUIRED), octet string of the form output from
                               signature_to_octets operation.

Outputs:

signature, a signature in the form (A, e, s), where A is a point in G1
           and e and s are non-zero scalars mod r.

Procedure:

1.  expected_len = octet_point_length + 2 * octet_scalar_length
2.  if length(signature_octets) != expected_len, return INVALID
3.  A_octets = signature_octets[0..(octet_point_length - 1)]
4.  A = octets_to_point_g1(A_octets)
5.  if A is INVALID, return INVALID
6.  if A == Identity_G1, return INVALID
7.  index = octet_point_length
8.  end_index = index + octet_scalar_length - 1
9.  e = OS2IP(signature_octets[index..end_index])
10. if e = 0 OR e &gt;= r, return INVALID
11. index += octet_scalar_length
12. end_index = index + octet_scalar_length - 1
13. s = OS2IP(signature_octets[index..end_index])
14. if s = 0 OR s &gt;= r, return INVALID
15. return (A, e, s)
</pre><a href="#section-4.4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signaturetooctets">
<section id="section-4.4.2">
          <h4 id="name-signaturetooctets">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-signaturetooctets" class="section-name selfRef">SignatureToOctets</a>
          </h4>
<p id="section-4.4.2-1">This operation describes how to encode a signature to an octet string.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2"><em>Note</em> this operation deliberately does not perform the relevant checks on the inputs <code>A</code>, <code>e</code> and <code>s</code>
because its assumed these are done prior to its invocation, e.g as is the case with the <a href="#sign">Sign</a> operation.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-3">
<pre>signature_octets = signature_to_octets(signature)

Inputs:

- signature (REQUIRED), a valid signature, in the form (A, e, s), where
                        A a point in G1 and e, s non-zero scalars mod r.

Outputs:

- signature_octets, octet string.

Procedure:

1. (A, e, s) = signature
2. A_octets = point_to_octets_g1(A)
3. e_octets = I2OSP(e, octet_scalar_length)
4. s_octets = I2OSP(s, octet_scalar_length)
5. return (A_octets || e_octets || s_octets)
</pre><a href="#section-4.4.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octetstoproof">
<section id="section-4.4.3">
          <h4 id="name-octetstoproof">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-octetstoproof" class="section-name selfRef">OctetsToProof</a>
          </h4>
<p id="section-4.4.3-1">This operation describes how to decode an octet string representing a proof, validate it and return the underlying components that make up the proof value.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2">The proof value outputted by this operation consists of the following components, in that order:<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.3-3">
<li id="section-4.4.3-3.1">Three (3) valid points of the G1 subgroup, each of which must not equal the identity point.<a href="#section-4.4.3-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.3-3.2">Five (5) integers representing scalars in the range of 1 to r-1 inclusive.<a href="#section-4.4.3-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.3-3.3">A set of integers representing scalars in the range of 1 to r-1 inclusive, corresponding to the undisclosed from the proof message commitments. This set can be empty (i.e., "()").<a href="#section-4.4.3-3.3" class="pilcrow">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.4.3-4">
<pre>proof = octets_to_proof(proof_octets)

Inputs:

- proof_octets (REQUIRED), octet string of the form outputted from the
                           proof_to_octets operation.

Parameters:

- r (REQUIRED), non-negative integer. The prime order of the G1 and
                G2 groups, defined by the ciphersuite.
- octet_scalar_length (REQUIRED), non-negative integer. The length of
                                  a scalar octet representation, defined
                                  by the ciphersuite.
- octet_point_length (REQUIRED), non-negative integer. The length of
                                 a point in G1 octet representation,
                                 defined by the ciphersuite.

Outputs:

- proof, a proof value in the form described above or INVALID

Procedure:

1.  proof_len_floor = 3 * octet_point_length + 5 * octet_scalar_length
2.  if length(proof_octets) &lt; proof_len_floor, return INVALID

// Points (i.e., (A', Abar, D) in ProofGen) de-serialization.
3.  index = 0
4.  for i in range(0, 2):
5.      end_index = index + octet_point_length - 1
6.      A_i = octets_to_point_g1(proof_octets[index..end_index])
7.      if A_i is INVALID or Identity_G1, return INVALID
8.      index += octet_point_length

// Scalars (i.e., (c, e^, r2^, r3^, s^, (m^_j1, ..., m^_jU)) in
// ProofGen) de-serialization.
9.  j = 0
10. while index &lt; length(proof_octets):
11.     end_index = index + octet_scalar_length - 1
12.     s_j = OS2IP(proof_octets[index..end_index])
13.     if s_j = 0 or if s_j &gt;= r, return INVALID
14.     index += octet_scalar_length
15.     j += 1

16. if index != length(proof_octets), return INVALID
17. msg_commitments = ()
18. If j &gt; 5, set msg_commitments = (s_5, ..., s_(j-1))
19. return (A_0, A_1, A_2, s_0, s_1, s_2, s_3, s_4, msg_commitments)
</pre><a href="#section-4.4.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="prooftooctets">
<section id="section-4.4.4">
          <h4 id="name-prooftooctets">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-prooftooctets" class="section-name selfRef">ProofToOctets</a>
          </h4>
<p id="section-4.4.4-1">This operation describes how to encode a proof, as computed at step 25 in <a href="#proofgen">ProofGen</a>, to an octet string. The input to the operation MUST be a valid proof.<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4.4-2">The inputed proof value must consist of the following components, in that order:<a href="#section-4.4.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.4-3">
<li id="section-4.4.4-3.1">Three (3) valid compressed points of the G1 subgroup, different from the identity point of G1 (i.e., <code>A', Abar, D</code>, in ProofGen)<a href="#section-4.4.4-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.4-3.2">Five (5) integers representing scalars in the range of 1 to r-1 inclusive (i.e., <code>c, e^, r2^, r3^, s^</code>, in ProofGen).<a href="#section-4.4.4-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.4-3.3">A number of integers representing scalars in the range of 1 to r-1 inclusive, corresponding to the undisclosed from the proof messages (i.e., <code>m^_j1, ..., m^_jU</code>, in ProofGen, where U the number of undisclosed messages).<a href="#section-4.4.4-3.3" class="pilcrow">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.4.4-4">
<pre>proof_octets = proof_to_octets(proof)

Inputs:

- proof (REQUIRED), a BBS proof in the form calculated by ProofGen in
                    step 25 (see above).

Parameters:

- octet_scalar_length (REQUIRED), non-negative integer. The length of
                                  a scalar octet representation, defined
                                  by the ciphersuite.

Outputs:

- proof_octets, octet string.

Procedure:

1. (A', Abar, D, c, e^, r2^, r3^, s^, (m^_1, ..., m^_U)) = proof
2. Let proof_octets be an empty octet string.

// Points Serialization.
3. for point in (A', Abar, D):
4.     point_octets = point_to_octets_g1(point)
5.     proof_octets = proof_octets || point_octets

// Scalar Serialization.
6. for scalar in (c, e^, r2^, r3^, s^, m^_1, ..., m^_U):
7.     scalar_octets = I2OSP(scalar, octet_scalar_length)
8.     proof_octets = proof_octets || scalar_octets
9. return proof_octets
</pre><a href="#section-4.4.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octetstopublickey">
<section id="section-4.4.5">
          <h4 id="name-octetstopublickey">
<a href="#section-4.4.5" class="section-number selfRef">4.4.5. </a><a href="#name-octetstopublickey" class="section-name selfRef">OctetsToPublicKey</a>
          </h4>
<p id="section-4.4.5-1">This operation describes how to decode an octet string representing a public key, validates it and returns the corresponding point in G2. Steps 2 to 5 check if the public key is valid. As an optimization, implementations MAY cache the result of those steps, to avoid unnecessarily repeating validation for known public keys.<a href="#section-4.4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.5-2">
<pre>W = octets_to_pubkey(PK)

Inputs:

- PK, octet string. A public key in the form ouputted by the SkToPK
      operation

Outputs:

- W, a valid point in G2 or INVALID

Procedure:

1. W = octets_to_point_g2(PK)
2. If W is INVALID, return INVALID
3. if subgroup_check(W) is INVALID, return INVALID
4. If W == Identity_G2, return INVALID
5. return W
</pre><a href="#section-4.4.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="encodeforhash">
<section id="section-4.4.6">
          <h4 id="name-encodeforhash">
<a href="#section-4.4.6" class="section-number selfRef">4.4.6. </a><a href="#name-encodeforhash" class="section-name selfRef">EncodeForHash</a>
          </h4>
<p id="section-4.4.6-1">This document uses the <code>hash_to_scalar</code> function to hash elements to scalars in the multiplicative group mod r (see <a href="#hash-to-scalar">Section 5.3</a>). To avoid ambiguity, elements passed to that operation, must first be encoded appropriately using <code>encode_for_hash</code>. The following procedure describes how to encode each element accordingly by serializing it to an appropriate format depending on its type and concatenating the results. Specifically,<a href="#section-4.4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.6-2.1">Points in G1 or G2 will be encoded using the <code>point_to_octets_g*</code> implementation for a particular ciphersuite.<a href="#section-4.4.6-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.6-2.2">Non-negative integers will be encoded using <code>I2OSP</code> with an output length of 8 bytes.<a href="#section-4.4.6-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.6-2.3">Scalars will be zero-extended to a fixed length, defined by a particular ciphersuite.<a href="#section-4.4.6-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.6-2.4">Octet strings will be zero-extended to a length that is a multiple of 8 bits. Then, the extended value is encoded directly.<a href="#section-4.4.6-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.6-2.5">ASCII strings will be transformed into octet strings using UTF-8 encoding.<a href="#section-4.4.6-2.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.6-3">After encoding, octet strings will be prepended with a value representing the length of their binary representation in the form of the number of bytes. This length must be encoded to octets using I2OSP with output length of 8 bytes. The combined value (encoded value + length prefix) binary representation is then encoded as a single octet string. For example, the string <code>0x14d</code> will be encoded as <code>0x0000000000000002014d</code>. If the length of the octet string is larger than 2^64 - 1, the octet string must be rejected. Similarly, ASCII strings, after encoded to octets (using utf8), will also be appended with the length of their octet-string representation.<a href="#section-4.4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.4.6-4">Optional input/parameters to operations that feature in a call to hash_to_scalar, that are not supplied to the operation should default to an empty octet string. For example, if X is an optional input/parameter that is not supplied, whilst A and B are required, then the procedural step of <code>hash(A || X || B)</code> MUST be evaluated to <code>hash(A || "" || B)</code>.<a href="#section-4.4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.4.6-5">The above is further described in the following procedure.<a href="#section-4.4.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.6-6">
<pre>result = encode_for_hash(input_array)

Inputs:

- input_array, an array of elements to be hashed. All elements of this
               array that are octet strings MUST be multiples of 8 bits.

Parameters:

- octet_scalar_length, non-negative integer. The length of a scalar
                       octet representation, defined by the ciphersuite.

Outputs:

- result, an octet string or INVALID.

Procedure:

1.  let octets_to_hash be an empty octet string.
2.  for el in input_array:
3.      if el is an ASCII string: el = utf8(el)
4.      if el is an octet string representing a public key: el_octs = el
5.      else if el is an octet string:
6.          if length(el) &gt; 2^64 - 1, return INVALID
7.          el_octs = I2OSP(length(el), 8) || el
8.      else if el is a Point in G1: el_octs = point_to_octets_g1(el)
9.      else if el is a Point in G2: el_octs = point_to_octets_g2(el)
10.     else if el is a Scalar: el_octs = I2OSP(el, octet_scalar_length)
11.     else if el is a non-negative integer: el_octs = I2OSP(el, 8)
12.     else: return INVALID
13.     octets_to_hash = octets_to_hash || el_octs
14. return octets_to_hash
</pre><a href="#section-4.4.6-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="validating-public-keys">
<section id="section-5.1">
        <h3 id="name-validating-public-keys">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-validating-public-keys" class="section-name selfRef">Validating public keys</a>
        </h3>
<p id="section-5.1-1">It is RECOMENDED for any operation in <a href="#core-operations">Core Operations</a> involving public keys, that they deserialize the public key first using the <a href="#octetstopublickey">OctetsToPublicKey</a> operation, even if they only require the octet-string representation of the public key. If the <code>octets_to_pubkey</code> procedure (see the <a href="#octetstopublickey">OctetsToPublicKey</a> section) returns INVALID, the calling operation should also return INVALID and abort. An example of where this recommendation applies is the <a href="#sign">Sign</a> operation. An example of where an explicit invocation to the <code>octets_to_pubkey</code> operation is already defined and therefore required is the <a href="#verify">Verify</a> operation.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="point-de-serialization">
<section id="section-5.2">
        <h3 id="name-point-de-serialization">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-point-de-serialization" class="section-name selfRef">Point de-serialization</a>
        </h3>
<p id="section-5.2-1">This document makes use of <code>octet_to_point_g*</code> to parse octet strings to elliptic curve points (either in G1 or G2). It is assumed (even if not explicitly described) that the result of this operation will not be INVALID. If <code>octet_to_point_g*</code> returns INVALID, then the calling operation should immediately return INVALID as well and abort the operation. Note that the only place where the output is assumed to be VALID implicitly is in the <a href="#encodingforhash">EncodingForHash</a> section.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="skipping-membership-checks">
<section id="section-5.3">
        <h3 id="name-skipping-membership-checks">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-skipping-membership-checks" class="section-name selfRef">Skipping membership checks</a>
        </h3>
<p id="section-5.3-1">Some existing implementations skip the subgroup_check invocation in <a href="#verify">Verify</a>, whose purpose is ensuring that the signature is an element of a prime-order subgroup.  This check is REQUIRED of conforming implementations, for two reasons.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">For most pairing-friendly elliptic curves used in practice, the pairing operation e <a href="#notation" class="xref">Section 1.2</a> is undefined when its input points are not in the prime-order subgroups of E1 and E2. The resulting behavior is unpredictable, and may enable forgeries.<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">Even if the pairing operation behaves properly on inputs that are outside the correct subgroups, skipping the subgroup check breaks the strong unforgeability property <span>[<a href="#ADR02" class="xref">ADR02</a>]</span>.<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="side-channel-attacks">
<section id="section-5.4">
        <h3 id="name-side-channel-attacks">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-side-channel-attacks" class="section-name selfRef">Side channel attacks</a>
        </h3>
<p id="section-5.4-1">Implementations of the signing algorithm SHOULD protect the secret key from side-channel attacks.  One method for protecting against certain side-channel attacks is ensuring that the implementation executes exactly the same sequence of instructions and performs exactly the same memory accesses, for any value of the secret key. In other words, implementations on the underlying pairing-friendly elliptic curve SHOULD run in constant time.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="randomness-considerations">
<section id="section-5.5">
        <h3 id="name-randomness-considerations">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-randomness-considerations" class="section-name selfRef">Randomness considerations</a>
        </h3>
<p id="section-5.5-1">The IKM input to KeyGen MUST be infeasible to guess and MUST be kept secret. One possibility is to generate IKM from a trusted source of randomness.  Guidelines on constructing such a source are outside the scope of this document.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">Secret keys MAY be generated using other methods; in this case they MUST be infeasible to guess and MUST be indistinguishable from uniformly random modulo r.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">BBS proofs are nondeterministic, meaning care must be taken against attacks arising from using bad randomness, for example, the nonce reuse attack on ECDSA <span>[<a href="#HDWH12" class="xref">HDWH12</a>]</span>. It is RECOMMENDED that the presentation header used in this specification contain a nonce chosen at random from a trusted source of randomness, see the <a href="#presentation-header-selection" class="xref">Section 5.6</a> for additional considerations.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">When a trusted source of randomness is used, signatures and proofs are much harder to forge or break due to the use of multiple nonces.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-header-selection">
<section id="section-5.6">
        <h3 id="name-presentation-header-selecti">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-presentation-header-selecti" class="section-name selfRef">Presentation header selection</a>
        </h3>
<p id="section-5.6-1">The signature proofs of knowledge generated in this specification are created using a specified presentation header. A verifier-specified cryptographically random value (e.g., a nonce) featuring in the presentation header provides strong protections against replay attacks, and is RECOMMENDED in most use cases. In some settings, proofs can be generated in a non-interactive fashion, in which case verifiers MUST be able to verify the uniqueness of the presentation header values.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementing-hash-to-curve-g1">
<section id="section-5.7">
        <h3 id="name-implementing-hash_to_curve_">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-implementing-hash_to_curve_" class="section-name selfRef">Implementing hash_to_curve_g1</a>
        </h3>
<p id="section-5.7-1">The security analysis models hash_to_curve_g1 as random oracles.  It is crucial that these functions are implemented using a cryptographically secure hash function.  For this purpose, implementations MUST meet the requirements of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">In addition, ciphersuites MUST specify unique domain separation tags for hash_to_curve.  Some guidance around defining this can be found in <a href="#ciphersuites" class="xref">Section 6</a>.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-underlying-curve">
<section id="section-5.8">
        <h3 id="name-choice-of-underlying-curve">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-choice-of-underlying-curve" class="section-name selfRef">Choice of underlying curve</a>
        </h3>
<p id="section-5.8-1">BBS signatures can be implemented on any pairing-friendly curve. However care MUST be taken when selecting one that is appropriate, this specification defines a ciphersuite for using the BLS12-381 curve in <a href="#ciphersuites" class="xref">Section 6</a> which as a curve achieves around 117 bits of security according to a recent NCC ZCash cryptography review <span>[<a href="#ZCASH-REVIEW" class="xref">ZCASH-REVIEW</a>]</span>.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-of-proofs-generated-by-proofgen">
<section id="section-5.9">
        <h3 id="name-security-of-proofs-generate">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-security-of-proofs-generate" class="section-name selfRef">Security of proofs generated by ProofGen</a>
        </h3>
<p id="section-5.9-1">The proof, as returned by ProofGen, is a zero-knowledge proof-of-knowledge <span>[<a href="#CDL16" class="xref">CDL16</a>]</span>. This guarantees that no information will be revealed about the signature itself or the undisclosed messages, from the output of ProofGen. Note that the security proofs in <span>[<a href="#CDL16" class="xref">CDL16</a>]</span> work on type 3 pairing setting. This means that G1 should be different from G2 and with no efficient isomorphism between them.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-6">
      <h2 id="name-ciphersuites">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-6-1">This section defines the format for a BBS ciphersuite. It also gives concrete ciphersuites based on the BLS12-381 pairing-friendly elliptic curve <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="ciphersuite-format">
<section id="section-6.1">
        <h3 id="name-ciphersuite-format">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ciphersuite-format" class="section-name selfRef">Ciphersuite Format</a>
        </h3>
<div id="ciphersuite-id">
<section id="section-6.1.1">
          <h4 id="name-ciphersuite-id">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-ciphersuite-id" class="section-name selfRef">Ciphersuite ID</a>
          </h4>
<p id="section-6.1.1-1">The following section defines the format of the unique identifier for the ciphersuite denoted <code>ciphersuite_id</code>. The REQUIRED format for this string is<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-2">
<pre>  "BBS_" || H2C_SUITE_ID || ADD_INFO
</pre><a href="#section-6.1.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-6.1.1-3.1">
              <p id="section-6.1.1-3.1.1">H2C_SUITE_ID is the suite ID of the hash-to-curve suite used to define the hash<em>to</em>curve function.<a href="#section-6.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-3.2">
              <p id="section-6.1.1-3.2.1">ADD_INFO is an optional string indicating any additional information used to uniquely qualify the ciphersuite. When present this value MUST only contain ASCII characters with codes between 0x21 and 0x7e (inclusive) and MUST end with an underscore (ASCII code: 0x5f), other than the last character the string MUST not contain any other underscores (ASCII code: 0x5f).<a href="#section-6.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="additional-parameters">
<section id="section-6.1.2">
          <h4 id="name-additional-parameters">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-additional-parameters" class="section-name selfRef">Additional Parameters</a>
          </h4>
<p id="section-6.1.2-1">The parameters that each ciphersuite needs to define are generally divided into three main categories; the basic parameters (a hash function etc.,), the serialization operations (point_to_octets_g1 etc.,) and the generator parameters. See below for more details.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2"><strong>Basic parameters</strong>:<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-3.1">
              <p id="section-6.1.2-3.1.1">hash: a cryptographic hash function.<a href="#section-6.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.2">
              <p id="section-6.1.2-3.2.1">octet_scalar_length: Number of bytes to represent a scalar value, in the multiplicative group of integers mod r, encoded as an octet string. It is RECOMMENDED this value be set to <code>ceil(log2(r)/8)</code>.<a href="#section-6.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.3">
              <p id="section-6.1.2-3.3.1">octet_point_length: Number of bytes to represent a point encoded as an octet string outputted by the <code>point_to_octets_g*</code> function. It is RECOMMENDED that this value is set to <code>ceil(log2(p)/8)</code>.<a href="#section-6.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.4">
              <p id="section-6.1.2-3.4.1">hash_to_curve_suite: The hash-to-curve ciphersuite id, in the form defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. This defines the hash_to_curve_g1 (the hash_to_curve operation for the G1 subgroup, see the <a href="#notation">Notation</a> section) and the expand_message (either expand_message_xmd or expand_message_xof) operations used in this document.<a href="#section-6.1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.2-4"><strong>Serialization functions</strong>:<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-5.1">
              <p id="section-6.1.2-5.1.1">point_to_octets_g1:
a function that returns the canonical representation of the point P for the G1 subgroup as an octet string.<a href="#section-6.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-5.2">
              <p id="section-6.1.2-5.2.1">point_to_octets_g2:
a function that returns the canonical representation of the point P for the G2 subgroup as an octet string.<a href="#section-6.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-5.3">
              <p id="section-6.1.2-5.3.1">octets_to_point_g1:
a function that returns the point P in the subgroup G1 corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of <code>point_to_octets_g1</code>.<a href="#section-6.1.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-5.4">
              <p id="section-6.1.2-5.4.1">octets_to_point_g2:
a function that returns the point P in the subgroup G2 corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of <code>point_to_octets_g2</code>.<a href="#section-6.1.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.2-6"><strong>Generator parameters</strong>:<a href="#section-6.1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-7.1">generator_seed: The seed used to determine the generator points which form part of the public parameters used by the BBS signature scheme. Note there are multiple possible scopes for this seed, including: a globally shared seed (where the resulting message generators are common across all BBS signatures); a signer specific seed (where the message generators are specific to a signer); and a signature specific seed (where the message generators are specific per signature). The ciphersuite MUST define this seed OR how to compute it as a pre-cursor operation to any others.<a href="#section-6.1.2-7.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="bls12-381-ciphersuites">
<section id="section-6.2">
        <h3 id="name-bls12-381-ciphersuites">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-bls12-381-ciphersuites" class="section-name selfRef">BLS12-381 Ciphersuites</a>
        </h3>
<p id="section-6.2-1">The following two ciphersuites are based on the BLS12-381 elliptic curves defined in Section 4.2.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>. The targeted security level of both suites in bits is <code>k = 128</code>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The first ciphersuite makes use of an extendable output function, and most specifically of SHAKE-256, as defined in Section 6.2 of <span>[<a href="#SHA3" class="xref">SHA3</a>]</span>. It also uses the hash-to-curve suite defined by this document in <a href="#bls12-381-hash_to_curve-def">Appendix A.1</a>, which also makes use of the SHAKE-256 function.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The second ciphersuite uses SHA-256, as defined in Section 6.2 of <span>[<a href="#SHA2" class="xref">SHA2</a>]</span> and the BLS12-381 G1 hash-to-curve suite defined in Section 8.8.1 of the <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> document.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Note that these two ciphersuites differ only in the hash function (SHAKE-256 vs SHA-256) and in the hash-to-curve suites used. The hash-to-curve suites differ in the <code>expand_message</code> variant and underlying hash function. More concretely, the <a href="#bls12-381-shake-256">BLS12-381-SHAKE-256</a> ciphersuite makes use of <code>expand_message_xof</code> with SHAKE-256, while <a href="#bls12-381-sha-256">BLS12-381-SHA-256</a> makes use of <code>expand_message_xmd</code> with SHA-256. Curve parameters are common between the two ciphersuites.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div id="bls12-381-shake-256">
<section id="section-6.2.1">
          <h4 id="name-bls12-381-shake-256">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-bls12-381-shake-256" class="section-name selfRef">BLS12-381-SHAKE-256</a>
          </h4>
<p id="section-6.2.1-1"><strong>Basic parameters</strong>:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-2.1">
              <p id="section-6.2.1-2.1.1">ciphersuite_id: "BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_"<a href="#section-6.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.2">
              <p id="section-6.2.1-2.2.1">hash: SHAKE-256 as defined in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span>.<a href="#section-6.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.3">
              <p id="section-6.2.1-2.3.1">octet_scalar_length: 32, based on the RECOMMENDED approach of <code>ceil(log2(r)/8)</code>.<a href="#section-6.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.4">
              <p id="section-6.2.1-2.4.1">octet_point_length: 48, based on the RECOMMENDED approach of <code>ceil(log2(p)/8)</code>.<a href="#section-6.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.5">
              <p id="section-6.2.1-2.5.1">hash_to_curve_suite: "BLS12381G1_XOF:SHAKE-256_SSWU_R0_" as defined in <a href="#bls12-381-hash-to-curve-definition-using-shake-256">Appendix A.1</a> for the G1 subgroup.<a href="#section-6.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.1-3"><strong>Serialization functions</strong>:<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-4.1">
              <p id="section-6.2.1-4.1.1">point_to_octets_g1: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.2">
              <p id="section-6.2.1-4.2.1">point_to_octets_g2: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.3">
              <p id="section-6.2.1-4.3.1">octets_to_point_g1: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup.<a href="#section-6.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.4">
              <p id="section-6.2.1-4.4.1">octets_to_point_g2: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup.<a href="#section-6.2.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.1-5"><strong>Generator parameters</strong>:<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-6.1">generator_seed: A global seed value of "BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_MESSAGE_GENERATOR_SEED" which is used by the <a href="#generator-point-computation">create_generators</a> operation to compute the required set of message generators.<a href="#section-6.2.1-6.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="bls12-381-sha-256">
<section id="section-6.2.2">
          <h4 id="name-bls12-381-sha-256">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-bls12-381-sha-256" class="section-name selfRef">BLS12-381-SHA-256</a>
          </h4>
<p id="section-6.2.2-1"><strong>Basic parameters</strong>:<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-2.1">
              <p id="section-6.2.2-2.1.1">Ciphersuite_ID: "BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_"<a href="#section-6.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.2">
              <p id="section-6.2.2-2.2.1">hash: SHA-256 as defined in <span>[<a href="#SHA2" class="xref">SHA2</a>]</span>.<a href="#section-6.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.3">
              <p id="section-6.2.2-2.3.1">octet_scalar_length: 32, based on the RECOMMENDED approach of <code>ceil(log2(r)/8)</code>.<a href="#section-6.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.4">
              <p id="section-6.2.2-2.4.1">octet_point_length: 48, based on the RECOMMENDED approach of <code>ceil(log2(p)/8)</code>.<a href="#section-6.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.5">
              <p id="section-6.2.2-2.5.1">hash_to_curve_suite: "BLS12381G1_XMD:SHA-256_SSWU_RO_" as defined in Section 8.8.1 of the <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for the G1 subgroup.<a href="#section-6.2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.2-3"><strong>Serialization functions</strong>:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-4.1">
              <p id="section-6.2.2-4.1.1">point_to_octets_g1: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.2">
              <p id="section-6.2.2-4.2.1">point_to_octets_g2: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.3">
              <p id="section-6.2.2-4.3.1">octets_to_point_g1: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup.<a href="#section-6.2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.4">
              <p id="section-6.2.2-4.4.1">octets_to_point_g2: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup.<a href="#section-6.2.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.2-5"><strong>Generator parameters</strong>:<a href="#section-6.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-6.1">generator_seed: A global seed value of "BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_MESSAGE_GENERATOR_SEED" which is used by the <a href="#generator-point-computation">create_generators</a> operation to compute the required set of message generators.<a href="#section-6.2.2-6.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="test-vectors">
<section id="section-6.2.3">
          <h4 id="name-test-vectors">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
          </h4>
<p id="section-6.2.3-1">The following section details a basic set of test vectors that can be used to confirm an implementations correctness<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2"><strong>NOTE</strong> All binary data below is represented as octet strings encoded in hexadecimal format<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
<p id="section-6.2.3-3"><strong>NOTE</strong> These fixtures are a work in progress and subject to change<a href="#section-6.2.3-3" class="pilcrow">¶</a></p>
<p id="section-6.2.3-4">Further fixtures are available in <a href="#additional-bls12-381-ciphersuite-test-vectors" class="xref">Appendix C</a><a href="#section-6.2.3-4" class="pilcrow">¶</a></p>
<div id="message-generators">
<section id="section-6.2.3.1">
            <h5 id="name-message-generators">
<a href="#section-6.2.3.1" class="section-number selfRef">6.2.3.1. </a><a href="#name-message-generators" class="section-name selfRef">Message Generators</a>
            </h5>
<p id="section-6.2.3.1-1">Following the procedure defined in <a href="#generator-point-computation" class="xref">Section 4.1</a> with an input seed value of<a href="#section-6.2.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.1-2">
<pre>BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_MESSAGE_GENERATOR_SEED
</pre><a href="#section-6.2.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.1-3">a dst of<a href="#section-6.2.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.1-4">
<pre>BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_
</pre><a href="#section-6.2.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.1-5">and a length value of 12<a href="#section-6.2.3.1-5" class="pilcrow">¶</a></p>
<p id="section-6.2.3.1-6">Outputs the following values (note that the first 2 correspond to <code>Q_1</code> and <code>Q_2</code>, while the next 10, to the message generators <code>H_1, ..., H_10</code>).<a href="#section-6.2.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.1-7">
<pre>{{ $generators[0] }}

{{ $generators[1] }}

{{ $generators[2] }}

{{ $generators[3] }}

{{ $generators[4] }}

{{ $generators[5] }}

{{ $generators[6] }}

{{ $generators[7] }}

{{ $generators[8] }}

{{ $generators[9] }}

{{ $generators[10] }}

{{ $generators[11] }}
</pre><a href="#section-6.2.3.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="key-pair">
<section id="section-6.2.3.2">
            <h5 id="name-key-pair">
<a href="#section-6.2.3.2" class="section-number selfRef">6.2.3.2. </a><a href="#name-key-pair" class="section-name selfRef">Key Pair</a>
            </h5>
<p id="section-6.2.3.2-1">Following the procedure defined in <a href="#keygen" class="xref">Section 3.3.1</a> with an input IKM value as follows<a href="#section-6.2.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.2-2">
<pre>{{ $keyPair.seed }}
</pre><a href="#section-6.2.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.2-3">Outputs the following SK value<a href="#section-6.2.3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.2-4">
<pre>{{ $keyPair.keyPair.secretKey }}
</pre><a href="#section-6.2.3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.2-5">Following the procedure defined in <a href="#sktopk" class="xref">Section 3.3.2</a> with an input SK value as above produces the following PK value<a href="#section-6.2.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.2-6">
<pre>{{ $keyPair.keyPair.publicKey }}
</pre><a href="#section-6.2.3.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-single-message-signature">
<section id="section-6.2.3.3">
            <h5 id="name-valid-single-message-signat">
<a href="#section-6.2.3.3" class="section-number selfRef">6.2.3.3. </a><a href="#name-valid-single-message-signat" class="section-name selfRef">Valid Single Message Signature</a>
            </h5>
<p id="section-6.2.3.3-1">Using the following header<a href="#section-6.2.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.3-2">
<pre>{{ $signatureFixtures.signature001.header }}
</pre><a href="#section-6.2.3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.3-3">And the following message<a href="#section-6.2.3.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.3-4">
<pre>{{ $signatureFixtures.signature001.messages[0] }}
</pre><a href="#section-6.2.3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.3-5">Along with the SK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Sign operations, yields the following output signature<a href="#section-6.2.3.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.3-6">
<pre>{{ $signatureFixtures.signature001.signature }}
</pre><a href="#section-6.2.3.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-signature">
<section id="section-6.2.3.4">
            <h5 id="name-valid-multi-message-signatu">
<a href="#section-6.2.3.4" class="section-number selfRef">6.2.3.4. </a><a href="#name-valid-multi-message-signatu" class="section-name selfRef">Valid Multi-Message Signature</a>
            </h5>
<p id="section-6.2.3.4-1">Using the following header<a href="#section-6.2.3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.4-2">
<pre>{{ $signatureFixtures.signature004.header }}
</pre><a href="#section-6.2.3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.4-3">And the following messages (<strong>Note</strong> the ordering of the messages MUST be preserved)<a href="#section-6.2.3.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.4-4">
<pre>{{ $signatureFixtures.signature004.messages[0] }}

{{ $signatureFixtures.signature004.messages[1] }}

{{ $signatureFixtures.signature004.messages[2] }}

{{ $signatureFixtures.signature004.messages[3] }}

{{ $signatureFixtures.signature004.messages[4] }}

{{ $signatureFixtures.signature004.messages[5] }}

{{ $signatureFixtures.signature004.messages[6] }}

{{ $signatureFixtures.signature004.messages[7] }}

{{ $signatureFixtures.signature004.messages[8] }}

{{ $signatureFixtures.signature004.messages[9] }}
</pre><a href="#section-6.2.3.4-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3.4-5">Along with the SK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Sign operations, yields the following output signature<a href="#section-6.2.3.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3.4-6">
<pre>{{ $signatureFixtures.signature004.signature }}
</pre><a href="#section-6.2.3.4-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document does not make any requests of IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">The authors would like to acknowledge the significant amount of academic work that preceeded the development of this document. In particular the original work of <span>[<a href="#BBS04" class="xref">BBS04</a>]</span> which was subsequently developed in <span>[<a href="#ASM06" class="xref">ASM06</a>]</span> and in <span>[<a href="#CDL16" class="xref">CDL16</a>]</span>. This last academic work is the one mostly used by this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The current state of this document is the product of the work of the Decentralized Identity Foundation Applied Cryptography Working group, which includes numerous active participants. In particular, the following individuals contributed ideas, feedback and wording that influenced this specification:<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Orie Steele, Christian Paquin, Alessandro Guggino and Tomislav Markovski<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
      <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-hash-to-curve-16.txt">https://www.ietf.org/archive/id/draft-irtf-cfrg-hash-to-curve-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-pairing-friendly-curves">[I-D.irtf-cfrg-pairing-friendly-curves]</dt>
      <dd>
<span class="refAuthor">Sakemi, Y.</span>, <span class="refAuthor">Kobayashi, T.</span>, <span class="refAuthor">Saito, T.</span>, and <span class="refAuthor">R. S. Wahby</span>, <span class="refTitle">"Pairing-Friendly Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-pairing-friendly-curves-10</span>, <time datetime="2021-07-30" class="refDate">30 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-10.txt">https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4868">[RFC4868]</dt>
      <dd>
<span class="refAuthor">Kelly, S.</span> and <span class="refAuthor">S. Frankel</span>, <span class="refTitle">"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"</span>, <span class="seriesInfo">RFC 4868</span>, <span class="seriesInfo">DOI 10.17487/RFC4868</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
      <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA2">[SHA2]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA3">[SHA3]</dt>
    <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10">
      <h2 id="name-informative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="ADR02">[ADR02]</dt>
      <dd>
<span class="refAuthor">An, J. H.</span>, <span class="refAuthor">Dodis, Y.</span>, and <span class="refAuthor">T. Rabin</span>, <span class="refTitle">"On the Security of Joint Signature and Encryption"</span>, <span class="seriesInfo">pages 83-107</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://doi.org/10.1007/3-540-46035-7_6">https://doi.org/10.1007/3-540-46035-7_6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ASM06">[ASM06]</dt>
      <dd>
<span class="refAuthor">Au, M. H.</span>, <span class="refAuthor">Susilo, W.</span>, and <span class="refAuthor">Y. Mu</span>, <span class="refTitle">"Constant-Size Dynamic k-TAA"</span>, <span class="seriesInfo">Springer, Berlin, Heidelberg</span>, <time datetime="2006" class="refDate">2006</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/11832072_8">https://link.springer.com/chapter/10.1007/11832072_8</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBS04">[BBS04]</dt>
      <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Boyen, X.</span>, and <span class="refAuthor">H. Shacham</span>, <span class="refTitle">"Short Group Signatures"</span>, <span class="seriesInfo">pages 41-55</span>, <time datetime="2004" class="refDate">2004</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-540-28628-8_3">https://link.springer.com/chapter/10.1007/978-3-540-28628-8_3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bowe19">[Bowe19]</dt>
      <dd>
<span class="refAuthor">Bowe, S.</span>, <span class="refTitle">"Faster subgroup checks for BLS12-381"</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/814">https://eprint.iacr.org/2019/814</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CDL16">[CDL16]</dt>
      <dd>
<span class="refAuthor">Camenisch, J.</span>, <span class="refAuthor">Drijvers, M.</span>, and <span class="refAuthor">A. Lehmann</span>, <span class="refTitle">"Anonymous Attestation Using the Strong Diffie Hellman Assumption Revisited"</span>, <span class="seriesInfo">Springer, Cham</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://eprint.iacr.org/2016/663.pdf">https://eprint.iacr.org/2016/663.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HDWH12">[HDWH12]</dt>
      <dd>
<span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Durumeric, Z.</span>, <span class="refAuthor">Wustrow, E.</span>, and <span class="refAuthor">J.A. Halderman</span>, <span class="refTitle">"Mining your Ps and Qs: Detection of widespread weak keys in network devices"</span>, <span class="seriesInfo">pages 205-220</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final228.pdf">https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final228.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-bls-signature">[I-D.irtf-cfrg-bls-signature]</dt>
      <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Gorbunov, S.</span>, <span class="refAuthor">Wahby, R. S.</span>, <span class="refAuthor">Wee, H.</span>, <span class="refAuthor">Wood, C. A.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"BLS Signatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bls-signature-05</span>, <time datetime="2022-06-16" class="refDate">16 June 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bls-signature-05.txt">https://www.ietf.org/archive/id/draft-irtf-cfrg-bls-signature-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZCASH-REVIEW">[ZCASH-REVIEW]</dt>
    <dd>
<span class="refAuthor">NCC Group</span>, <span class="refTitle">"Zcash Overwinter Consensus and Sapling Cryptography Review"</span>, <span>&lt;<a href="https://research.nccgroup.com/wp-content/uploads/2020/07/NCC_Group_Zcash2018_Public_Report_2019-01-30_v1.3.pdf">https://research.nccgroup.com/wp-content/uploads/2020/07/NCC_Group_Zcash2018_Public_Report_2019-01-30_v1.3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="bls12-381-hash-to-curve-definition-using-shake-256">
<section id="appendix-A">
      <h2 id="name-bls12-381-hash_to_curve-def">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-bls12-381-hash_to_curve-def" class="section-name selfRef">BLS12-381 hash_to_curve definition using SHAKE-256</a>
      </h2>
<p id="appendix-A-1">The following defines a hash_to_curve suite <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for the BLS12-381 curve for both the G1 and G2 subgroups using the extendable output function (xof) of SHAKE-256 as per the guidance defined in section 8.9 of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Note the notation used in the below definitions is sourced from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="bls12-381-g1">
<section id="appendix-A.1">
        <h3 id="name-bls12-381-g1">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-bls12-381-g1" class="section-name selfRef">BLS12-381 G1</a>
        </h3>
<p id="appendix-A.1-1">The suite of <code>BLS12381G1_XOF:SHAKE-256_SSWU_R0_</code> is defined as follows:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>* encoding type: hash_to_curve (Section 3 of
                 [@!I-D.irtf-cfrg-hash-to-curve])

* E: y^2 = x^3 + 4

* p: 0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f624
     1eabfffeb153ffffb9feffffffffaaab

* r: 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001

* m: 1

* k: 128

* expand_message: expand_message_xof (Section 5.3.2 of
                  [@!I-D.irtf-cfrg-hash-to-curve])

* hash: SHAKE-256

* L: 64

* f: Simplified SWU for AB == 0 (Section 6.6.3 of
     [@!I-D.irtf-cfrg-hash-to-curve])

* Z: 11

*  E': y'^2 = x'^3 + A' * x' + B', where

      -  A' = 0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aef
                d881ac98936f8da0e0f97f5cf428082d584c1d

      -  B' = 0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14f
                cef35ef55a23215a316ceaa5d1cc48e98e172be0

*  iso_map: the 11-isogeny map from E' to E given in Appendix E.2 of
            [@!I-D.irtf-cfrg-hash-to-curve]

*  h_eff: 0xd201000000010001
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">Note that the h_eff values for this suite are copied from that defined for the <code>BLS12381G1_XMD:SHA-256_SSWU_RO_</code> suite defined in section 8.8.1 of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">An optimized example implementation of the Simplified SWU mapping to the curve E' isogenous to BLS12-381 G1 is given in Appendix F.2 <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="use-cases">
<section id="appendix-B">
      <h2 id="name-use-cases">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="non-correlating-security-token">
<section id="appendix-B.1">
        <h3 id="name-non-correlating-security-to">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-non-correlating-security-to" class="section-name selfRef">Non-correlating Security Token</a>
        </h3>
<p id="appendix-B.1-1">In the most general sense BBS signatures can be used in any application where a cryptographically secured token is required but correlation caused by usage of the token is un-desirable.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">For example in protocols like OAuth2.0 the most commonly used form of the access token leverages the JWT format alongside conventional cryptographic primitives such as traditional digital signatures or HMACs. These access tokens are then used by a relying party to prove authority to a resource server during a request. However, because the access token is most commonly sent by value as it was issued by the authorization server (e.g in a bearer style scheme), the access token can act as a source of strong correlation for the relying party. Relevant prior art can be found <a href="https://www.ietf.org/archive/id/draft-private-access-tokens-01.html">here</a>.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">BBS Signatures due to their unique properties removes this source of correlation but maintains the same set of guarantees required by a resource server to validate an access token back to its relevant authority (note that an approach to signing JSON tokens with BBS that may be of relevance is the <a href="https://json-web-proofs.github.io/json-web-proofs/draft-jmiller-json-web-proof.html">JWP</a> format and serialization). In the context of a protocol like OAuth2.0 the access token issued by the authorization server would feature a BBS Signature, however instead of the relying party providing this access token as issued, in their request to a resource server, they generate a unique proof from the original access token and include that in the request instead, thus removing this vector of correlation.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="improved-bearer-security-token">
<section id="appendix-B.2">
        <h3 id="name-improved-bearer-security-to">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-improved-bearer-security-to" class="section-name selfRef">Improved Bearer Security Token</a>
        </h3>
<p id="appendix-B.2-1">Bearer based security tokens such as JWT based access tokens used in the OAuth2.0 protocol are a highly popular format for expressing authorization grants. However their usage has several security limitations. Notably a bearer based authorization scheme often has to rely on a secure transport between the authorized party (client) and the resource server to mitigate the potential for a MITM attack or a malicious interception of the access token. The scheme also has to assume a degree of trust in the resource server it is presenting an access token to, particularly when the access token grants more than just access to the target resource server, because in a bearer based authorization scheme, anyone who possesses the access token has authority to what it grants. Bearer based access tokens also suffer from the threat of replay attacks.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">Improved schemes around authorization protocols often involve adding a layer of proof of cryptographic key possession to the presentation of an access token, which mitigates the deficiencies highlighted above as well as providing a way to detect a replay attack. However, approaches that involve proof of cryptographic key possession such as DPoP (<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-dpop-04">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-dpop-04</a>) suffer from an increase in protocol complexity. A party requesting authorization must pre-generate appropriate key material, share the public portion of this with the authorization server alongside proving possession of the private portion of the key material. The authorization server must also be-able to accommodate receiving this information and validating it.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">BBS Signatures ofter an alternative model that solves the same problems that proof of cryptographic key possession schemes do for bearer based schemes, but in a way that doesn't introduce new up-front protocol complexity. In the context of a protocol like OAuth2.0 the access token issued by the authorization server would feature a BBS Signature, however instead of the client providing this access token as issued, in their request to a resource server, they generate a unique proof from the original access token and include that in the request instead. Because the access token is not shared in a request to a resource server, attacks such as MITM are mitigated. A resource server also obtains the ability to detect a replay attack by ensuring the proof presented is unique.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selectively-disclosure-enabled-identity-credentials">
<section id="appendix-B.3">
        <h3 id="name-selectively-disclosure-enab">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-selectively-disclosure-enab" class="section-name selfRef">Selectively Disclosure Enabled Identity Credentials</a>
        </h3>
<p id="appendix-B.3-1">BBS signatures when applied to the problem space of identity credentials can help to enhance user privacy. For example a digital drivers license that is cryptographically signed with a BBS signature, allows the holder or subject of the license to disclose different claims from their drivers license to different parties. Furthermore, the unlinkable presentations property of proofs generated by the scheme remove an important possible source of correlation for the holder across multiple presentations.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-bls12-381-ciphersuite-test-vectors">
<section id="appendix-C">
      <h2 id="name-additional-bls12-381-cipher">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-additional-bls12-381-cipher" class="section-name selfRef">Additional BLS12-381 Ciphersuite Test Vectors</a>
      </h2>
<p id="appendix-C-1"><strong>NOTE</strong> These fixtures are a work in progress and subject to change<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="modified-message-signature">
<section id="appendix-C.1">
        <h3 id="name-modified-message-signature">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-modified-message-signature" class="section-name selfRef">Modified Message Signature</a>
        </h3>
<p id="appendix-C.1-1">Using the following header<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-2">
<pre>{{ $signatureFixtures.signature002.header }}
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-3">And the following message<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-4">
<pre>{{ $signatureFixtures.signature002.messages[0] }}
</pre><a href="#appendix-C.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-5">And the following signature<a href="#appendix-C.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-6">
<pre>{{ $signatureFixtures.signature002.signature }}
</pre><a href="#appendix-C.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-7">Along with the PK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Verify operation should fail signature validation due to the message value being different from what was signed<a href="#appendix-C.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extra-unsigned-message-signature">
<section id="appendix-C.2">
        <h3 id="name-extra-unsigned-message-sign">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-extra-unsigned-message-sign" class="section-name selfRef">Extra Unsigned Message Signature</a>
        </h3>
<p id="appendix-C.2-1">Using the following header<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-2">
<pre>{{ $signatureFixtures.signature003.header }}
</pre><a href="#appendix-C.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-3">And the following messages<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-4">
<pre>{{ $signatureFixtures.signature003.messages[0] }}

{{ $signatureFixtures.signature003.messages[1] }}
</pre><a href="#appendix-C.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-5">And the following signature<a href="#appendix-C.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-6">
<pre>{{ $signatureFixtures.signature002.signature }}
</pre><a href="#appendix-C.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-7">Along with the PK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Verify operation should fail signature validation due to an additional message being supplied that was not signed<a href="#appendix-C.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="missing-message-signature">
<section id="appendix-C.3">
        <h3 id="name-missing-message-signature">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-missing-message-signature" class="section-name selfRef">Missing Message Signature</a>
        </h3>
<p id="appendix-C.3-1">Using the following header<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-2">
<pre>{{ $signatureFixtures.signature005.header }}
</pre><a href="#appendix-C.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.3-3">And the following messages<a href="#appendix-C.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-4">
<pre>{{ $signatureFixtures.signature005.messages[0] }}

{{ $signatureFixtures.signature005.messages[1] }}
</pre><a href="#appendix-C.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.3-5">And the following signature<a href="#appendix-C.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-6">
<pre>{{ $signatureFixtures.signature005.signature }}
</pre><a href="#appendix-C.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.3-7">Along with the PK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Verify operation should fail signature validation due to missing messages that were originally present during the signing<a href="#appendix-C.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reordered-message-signature">
<section id="appendix-C.4">
        <h3 id="name-reordered-message-signature">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-reordered-message-signature" class="section-name selfRef">Reordered Message Signature</a>
        </h3>
<p id="appendix-C.4-1">Using the following header<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-2">
<pre>{{ $signatureFixtures.signature006.header }}
</pre><a href="#appendix-C.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.4-3">And the following messages<a href="#appendix-C.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-4">
<pre>{{ $signatureFixtures.signature006.messages[0] }}

{{ $signatureFixtures.signature006.messages[1] }}

{{ $signatureFixtures.signature006.messages[2] }}

{{ $signatureFixtures.signature006.messages[3] }}

{{ $signatureFixtures.signature006.messages[4] }}

{{ $signatureFixtures.signature006.messages[5] }}

{{ $signatureFixtures.signature006.messages[6] }}

{{ $signatureFixtures.signature006.messages[7] }}

{{ $signatureFixtures.signature006.messages[8] }}

{{ $signatureFixtures.signature006.messages[9] }}
</pre><a href="#appendix-C.4-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.4-5">And the following signature<a href="#appendix-C.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-6">
<pre>{{ $signatureFixtures.signature006.signature }}
</pre><a href="#appendix-C.4-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.4-7">Along with the PK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Verify operation should fail signature validation due to messages being re-ordered from the order in which they were signed<a href="#appendix-C.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrong-public-key-signature">
<section id="appendix-C.5">
        <h3 id="name-wrong-public-key-signature">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-wrong-public-key-signature" class="section-name selfRef">Wrong Public Key Signature</a>
        </h3>
<p id="appendix-C.5-1">Using the following header<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5-2">
<pre>{{ $signatureFixtures.signature007.header }}
</pre><a href="#appendix-C.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5-3">And the following messages<a href="#appendix-C.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5-4">
<pre>{{ $signatureFixtures.signature007.messages[0] }}

{{ $signatureFixtures.signature007.messages[1] }}

{{ $signatureFixtures.signature007.messages[2] }}

{{ $signatureFixtures.signature007.messages[3] }}

{{ $signatureFixtures.signature007.messages[4] }}

{{ $signatureFixtures.signature007.messages[5] }}

{{ $signatureFixtures.signature007.messages[6] }}

{{ $signatureFixtures.signature007.messages[7] }}

{{ $signatureFixtures.signature007.messages[8] }}

{{ $signatureFixtures.signature007.messages[9] }}
</pre><a href="#appendix-C.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5-5">And the following signature<a href="#appendix-C.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5-6">
<pre>{{ $signatureFixtures.signature007.signature }}
</pre><a href="#appendix-C.5-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5-7">Along with the PK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Verify operation should fail signature validation due to public key used to verify is in-correct<a href="#appendix-C.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrong-public-key-signature-1">
<section id="appendix-C.6">
        <h3 id="name-wrong-public-key-signature-2">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-wrong-public-key-signature-2" class="section-name selfRef">Wrong Public Key Signature</a>
        </h3>
<p id="appendix-C.6-1">Using the following header<a href="#appendix-C.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.6-2">
<pre>{{ $signatureFixtures.signature008.header }}
</pre><a href="#appendix-C.6-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.6-3">And the following messages<a href="#appendix-C.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.6-4">
<pre>{{ $signatureFixtures.signature008.messages[0] }}

{{ $signatureFixtures.signature008.messages[1] }}

{{ $signatureFixtures.signature008.messages[2] }}

{{ $signatureFixtures.signature008.messages[3] }}

{{ $signatureFixtures.signature008.messages[4] }}

{{ $signatureFixtures.signature008.messages[5] }}

{{ $signatureFixtures.signature008.messages[6] }}

{{ $signatureFixtures.signature008.messages[7] }}

{{ $signatureFixtures.signature008.messages[8] }}

{{ $signatureFixtures.signature008.messages[9] }}
</pre><a href="#appendix-C.6-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.6-5">And the following signature<a href="#appendix-C.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.6-6">
<pre>{{ $signatureFixtures.signature008.signature }}
</pre><a href="#appendix-C.6-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.6-7">Along with the PK value as defined in <a href="#key-pair" class="xref">Section 6.2.3.2</a> as inputs into the Verify operation should fail signature validation due to header value being modified from what was originally signed<a href="#appendix-C.6-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="proof-generation-and-verification-algorithmic-explanation">
<section id="appendix-D">
      <h2 id="name-proof-generation-and-verifi">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-proof-generation-and-verifi" class="section-name selfRef">Proof Generation and Verification Algorithmic Explanation</a>
      </h2>
<p id="appendix-D-1">The following section provides an explanation of how the ProofGen and ProofVerify operations work.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Let the prover be in possession of a BBS signature <code>(A, e, s)</code> on messages <code>msg_1, ..., msg_L</code> and a <code>domain</code> value (see <a href="#sign">Sign</a>). Let <code>A = B * (1/(e + SK))</code> where <code>SK</code> the signer's secret key and,<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-3">
<pre>B = P1 + Q_1 * s + Q_2 * domain + H_1 * msg_1 + ... + H_L * msg_L
</pre><a href="#appendix-D-3" class="pilcrow">¶</a>
</div>
<p id="appendix-D-4">Let <code>(i1, ..., iR)</code> be the indexes of generators corresponding to messages the prover wants to disclose and <code>(j1, ..., jU)</code> be the indexes corresponding to undisclosed messages (i.e., <code>(j1, ..., jU) = range(1, L) \ (i1, ..., iR)</code>). To prove knowledge of a signature on the disclosed messages, work as follows,<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-5.1">
          <p id="appendix-D-5.1.1">Hide the signature by randomizing it. To randomize the signature <code>(A, e, s)</code>, take uniformly random <code>r1</code>, <code>r2</code> in <code>[1, r-1]</code>, and calculate,<a href="#appendix-D-5.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-5.1.2">
<pre>1.  A' = A * r1,
2.  Abar = A' * (-e) + B * r1
3.  D = B * r1 + Q_1 * r2.
</pre><a href="#appendix-D-5.1.2" class="pilcrow">¶</a>
</div>
<p id="appendix-D-5.1.3">Also set,<a href="#appendix-D-5.1.3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-5.1.4">
<pre>4.  r3 = r1 ^ -1 mod r
5.  s' = r2 * r3 + s mod r.
</pre><a href="#appendix-D-5.1.4" class="pilcrow">¶</a>
</div>
<p id="appendix-D-5.1.5">The values <code>(A', Abar, D)</code> will be part of the proof and are used to prove possession of a BBS signature, without revealing the signature itself. Note that; <code>e(A', PK) = e(Abar, P2)</code> where <code>PK</code> the signer's public key and <code>P2</code> the base element in <code>G2</code> (used to create the signer's <code>PK</code>, see <a href="#sktopk">SkToPk</a>). This also serves to bind the proof to the signer's <code>PK</code>.<a href="#appendix-D-5.1.5" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.2">
          <p id="appendix-D-5.2.1">Set the following,<a href="#appendix-D-5.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-5.2.2">
<pre>1.  C1 = Abar - D
2.  C2 = P1 + Q_2 * domain + H_i1 * msg_i1 + ... + H_iR * msg_iR
</pre><a href="#appendix-D-5.2.2" class="pilcrow">¶</a>
</div>
<p id="appendix-D-5.2.3">Create a non-interactive zero-knowledge proof-of-knowledge (<code>nizk</code>) of the values <code>e, r2, r3, s'</code> and <code>msg_j1, ..., msg_jU</code> (the undisclosed messages) so that both of the following equalities hold,<a href="#appendix-D-5.2.3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-5.2.4">
<pre>EQ1.  C1 = A' * (-e) - Q_1 * r2
EQ2.  C2 = Q_1 * s' - D * r3 + H_j1 * msg_j1 + ... + H_jU * msg_jU.
</pre><a href="#appendix-D-5.2.4" class="pilcrow">¶</a>
</div>
</li>
      </ul>
<p id="appendix-D-6">Note that the verifier will know the elements in the left side of the above equations (i.e., <code>C1</code> and <code>C2</code>) but not in the right side (i.e., <code>s'</code>, <code>r3</code> and the undisclosed messages: <code>msg_j1, ..., msg_jU</code>). However, using the <code>nizk</code>, the prover can convince the verifier that they (the prover) know the elements that satisfy those equations, without disclosing them. Then, if both EQ1 and EQ2 hold, and <code>e(A', PK) = e(Abar, P2)</code>, an extractor can return a valid BBS signature from the signer's <code>SK</code>, on the disclosed messages. The proof returned is <code>(A', Abar, D, nizk)</code>. To validate the proof, a verifier checks that <code>e(A', PK) = e(Abar, P2)</code> and verifies the <code>nizk</code>. Validating the proof, will guarantee the authenticity and integrity of the disclosed messages, as well as ownership of the undisclosed messages and of the signature.<a href="#appendix-D-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-E">
      <h2 id="name-document-history">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-E-1">-00<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-2.1">Initial version<a href="#appendix-E-2.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-3">-01<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-4.1">Populated fixtures<a href="#appendix-E-4.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vasilis Kalos</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vasilis.kalos@mattr.global" class="email">vasilis.kalos@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andrew Whitehead</span></div>
<div dir="auto" class="left"><span class="org">Portage</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andrew.whitehead@portagecybertech.com" class="email">andrew.whitehead@portagecybertech.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Lodder</span></div>
<div dir="auto" class="left"><span class="org">CryptID</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:redmike7@gmail.com" class="email">redmike7@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
